{%- comment -%}
Password page gate: graffiti canvas + email capture.
Unlocks password modal only after successful email submit.
Sends graffiti as a data URL in the contact email body.
{%- endcomment -%}

<section class="graffiti-gate color-{{ section.settings.color_scheme }} gradient" data-graffiti-gate>
  <div class="graffiti-gate__bg concrete-bg" aria-hidden="true">
    <img class="graffiti-gate__img" src="{{ 'your-texture.jpg' | asset_url }}" alt="" loading="eager" decoding="async" />
  </div>
  <canvas id="graffiti-canvas" class="graffiti-gate__canvas" role="img" aria-label="Graffiti drawing area"></canvas>

  <div class="graffiti-gate__ui">
    <div class="graffiti-copy graffiti-hideable">
      <h3 class="graffiti-h3">Share your work</h3>
      <h3 class="graffiti-h3">@radiohighdigital</h3>
    </div>

    <div class="graffiti-gate__group graffiti-gate__group--colors graffiti-hideable" aria-label="Choose color">
      {%- assign colors = section.settings.palette | split: ',' -%}
      {%- for c in colors -%}
        {%- assign c_trim = c | strip -%}
        <button type="button" class="graffiti-color" style="--c: {{ c_trim }}" data-color="{{ c_trim }}" aria-pressed="{% if forloop.first %}true{% else %}false{% endif %}" aria-label="Color {{ c_trim }}"></button>
      {%- endfor -%}
    </div>

    <div class="graffiti-gate__group graffiti-size-wrap graffiti-hideable" aria-label="Cap size">
      <label id="graffiti-size-label" for="graffiti-size" class="graffiti-label">Cap Size: <span id="graffiti-size-display">16</span></label>
      <input id="graffiti-size" class="graffiti-size" type="range" min="6" max="48" value="16" step="1" aria-labelledby="graffiti-size-label graffiti-size-display" />
      <span id="graffiti-cap-preview" class="graffiti-cap-preview" aria-hidden="true"></span>
    </div>

    <div class="graffiti-gate__group graffiti-hideable">
      <button id="graffiti-undo" type="button" class="graffiti-btn">Undo</button>
      <button id="graffiti-clear" type="button" class="graffiti-btn">Clear</button>
    </div>
    <button type="button" id="graffiti-toggle" class="graffiti-toggle" aria-pressed="false" aria-label="Hide controls">Hide Controls</button>
  </div>
</section>

{% schema %}
{
  "name": "Graffiti Gate",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "palette",
      "default": "#000000,#ffffff,#c0c0c0,#ff0000,#ff69b4,#1e90ff",
      "label": "Palette (comma-separated colors)"
    }
  ]
}
{% endschema %}
